<!DOCTYPE html>
<html>
<head>
    <!--    https://www.w3schools.com/tags/tag_meta.asp-->
    <meta charset="utf-8">
    <meta name="description" content="Osmosis: RGBD Diffusion Prior for Underwater Image Restoration">
    <meta name="keywords" content="Osmosis, Diffusion, Posterior Sampling, underwater, image restoration">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Osmosis: RGBD Diffusion Prior for Underwater Image Restoration</title>

    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'G-PYVRSFMDRL');
    </script>
    
    <title>LaTeX in HTML</title>
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    
    <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
          rel="stylesheet">

    <link rel="stylesheet" href="./static/css/bulma.min.css">
    <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
    <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
    <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
    <link rel="stylesheet" href="./static/css/index.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script defer src="./static/js/fontawesome.all.min.js"></script>
    <script src="./static/js/bulma-carousel.min.js"></script>
    <script src="./static/js/bulma-slider.min.js"></script>
    <script src="./static/js/index.js"></script>
    <!--    <script src='./static/js/jquery.elevatezoom.js'></script>-->
    <link rel="shortcut icon" href="images/lab_icon.png" type="image/png"/>

    <!-- TwentyTwenty CSS -->
    <link rel="stylesheet" href="static/css/twentytwenty.css" type="text/css" media="screen" />

    <!-- jQuery (necessary for TwentyTwenty plugin) -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

    <!-- Styles for the page and TwentyTwenty plugin -->
    <style>
        .twentytwenty-container img { width: 100%; }
    </style>

    <!-- Dependencies -->
    <script src="static/js/jquery-3.2.1.min.js" type="text/javascript"></script>
    <script src="static/js/jquery.event.move.js" type="text/javascript"></script>
    <!-- TwentyTwenty JS -->
    <script src="static/js/jquery.twentytwenty.js" type="text/javascript"></script>

</head>
<body>

<!-- title -->
<section class="hero">
    <div class="hero-body">
        <div class="container">
            <div class="columns is-centered">
                <div class="column has-text-centered">
                    <h1 class="title is-1 publication-title mb-4">Osmosis: RGBD Diffusion Prior for <br> Underwater Image Restoration</h1>
                    <br>
                    <div class="is-size-5 publication-authors">
                        <span class="author-block">Opher Bar Nathan<sup>1</sup>,</span>
                        <span class="author-block">Deborah Levy<sup>1</sup>,</span>
                        <span class="author-block">
                            <a href="https://www.viseaon.haifa.ac.il/">Tali Treibitz</a><sup>1</sup>,
                        </span>
                        <span class="author-block">
                        <a href="https://danrsm.github.io/">Dan Rosenbaum</a><sup>2</sup>
                        </span>
                    </div>
                    <br>
                    <div class="is-size-5 publication-authors">
                        <span class="institution-block">
                          <span class="instit"><sup>1</sup>Dept. of Marine Technologies,
                            <br>School of Marine Sciences
                            <br>University of Haifa, Israel
                          </span>
                          <span class="instit"><sup>2</sup>Dept. of Computer Science,
                            <br>University of Haifa, Israel
                          </span>
                        </span>
                    </div>
                    <h1 style="font-size:24px;font-weight:bold">ECCV 2024</h1>
                    <div class="column has-text-centered">

                        <!-- <h1 class="title is-5">Links for the paper and code will be published soon</h1> -->
                        <span class="link-block">    
                            <a href="https://arxiv.org/abs/2403.14837"
                                class="external-link button is-normal is-rounded is-dark">
                                <span class="icon">
                                    <i class="ai ai-arxiv is-size-4"></i></span>
                                <span>Paper</span>
                            </a>
                        </span>

                        <span class="link-block">
                            <a href="https://github.com/osmosis-diffusion/osmosis-diffusion-code"
                                class="external-link button is-normal is-rounded is-dark">
                                <span class="icon">
                                    <i class="fab fa-github  is-size-4"></i>
                                </span>
                                <span>Code & Datasets</span>
                            </a>
                        </span>

                        <!--

                        <div class="publication-links">
                        
                            <span class="link-block">
                                <a href="https://www.youtube.com/watch?v=jVqWGPzgrLw"
                                     class="external-link button is-normal is-rounded is-dark">
                                    <span class="icon">
                                        <i class="fab fa-youtube"></i>
                                    </span>
                                    <span>Video</span>
                                </a>
                            </span> 
 
                        </div>
                        -->

                    </div>
                    <img class="img-teaser" src="figures/teaser2.png">
                    
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Abstract -->
<section class="section">
    <div class="container">
        <!-- Abstract. -->
        <div class="columns is-centered has-text-centered">
            <div class="column is-two-thirds">
                <h2 class="title is-2">Abstract</h2>
                <div class="content has-text-justified" style="font-size: 18px;">
                    <p>
                        <!-- Underwater image restoration is a challenging task because of strong water effects that increase dramatically with distance. 
                        This is worsened by lack of ground truth data of clean scenes without water. 
                        Diffusion priors have emerged as strong image restoration priors. 
                        However, they are often trained with a dataset of the desired restored output, which is not available in our case. 
                        <br><br>
                        To overcome this critical issue, we show how to leverage in-air images to train diffusion priors for underwater restoration. 
                        We observe that only color data is insufficient, and augment the prior with a depth channel. 
                        Thus, we train an unconditional diffusion model prior on the joint space of color and depth, using standard RGBD datasets of natural outdoor scenes in air.
                        <br><br>
                        Using this prior together with a novel guidance method based on the underwater image formation model, we generate posterior samples of clean images, removing the water effects. 
                        Even though our prior did not see any underwater images during training, 
                        our method outperforms state-of-the-art baselines both for image restoration and depth estimation on very challenging scenes. -->
                        Underwater image restoration is a challenging task because of water effects that increase dramatically with distance. 
                        This is worsened by lack of ground truth data of clean scenes without water. 
                        Diffusion priors have emerged as strong image restoration priors. 
                        However, they are often trained with a dataset of the desired restored output, which is not available in our case.
                        <br><br>
                        We also observe that using only color data is insufficient, and therefore augment the prior with a depth channel. 
                        We train an unconditional diffusion model prior on the joint space of color and depth, using standard RGBD datasets of natural outdoor scenes in air. 
                        Using this prior together with a novel guidance method based on the underwater 
                        image formation model, we generate posterior samples of clean images, removing the water effects.
                        <br><br>
                        Even though our prior did not see any underwater images during training, our method outperforms state-of-the-art baselines for image restoration on very challenging scenes.
                        Our code, models and data are available on the project’s website.



                    </p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Image Restoration comparison -->
<section class="hero">
    <div class="hero-body">
        <div class="container">
            <div class="columns is-centered">
                <div class="column is-three-quarters has-text-centered">
                    <h1 class="title is-3">Underwater Image Restoration</h1>
                    <h1 class="title is-5">Results Comparison for Underwater Image Restoration</h1>
                    <!-- dataset link -->
                    <!-- <span class="link-block">
                        <a href=""
                           class="button is-normal is-rounded is-dark">
                          <span class="icon"> <i class="fas fa-images is-size-4"></i> </span>
                          <span> &nbsp Download Underwater Dataset</span>
                        </a>
                    </span> -->
                    <!-- Image restoration results link -->
                    <!-- <span class="link-block">
                        <a href=""
                           class="button is-normal is-rounded is-dark">
                          <span class="icon"> <i class="fas fa-images is-size-4"></i> </span>
                          <span> &nbsp Download Results</span>
                        </a>
                    </span> -->
                    
                    <br><br>
                    <p class="has-text-justified" style="font-size: 18px;">
                        Comparison with several underwater methods. <br>
                        Select a scene from the upper row and a method from the right column. <br>
                        The input underwater image is labeled '1. Underwater,' and our result is '8. Osmosis'. <br>
                        The Osmosis result is shown on the left side, with the compared method displayed on the right.
                    </p>
                    <br>

                    <div class="row">       
                        <!-- scenes small images - with click option -->
                        <div class="column-viewer">
                            <button class="button-syn" onclick="change_scene_real(1);">
                                <h1 class="is-text is-size-6 has-text-weight-semibold">scene#1</h1>
                                <input type="image" src="images/rgb/scene1/input.png"
                                       style="border: double; border-radius: inherit" height="90"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_real(2);">
                                <h1 class="is-text is-size-6  has-text-weight-semibold">scene#2</h1>
                                <input type="image" src="images/rgb/scene2/input.png"
                                       style="border: double; border-radius: inherit" height="90"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_real(3);">
                                <h1 class="is-text is-size-6  has-text-weight-semibold">scene#3</h1>
                                <input type="image" src="images/rgb/scene3/input.png"
                                       style="border: double; border-radius: inherit" height="90"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_real(4);">
                                <h1 class="is-text is-size-6  has-text-weight-semibold">scene#4</h1>
                                <input type="image" src="images/rgb/scene4/input.png"
                                       style="border: double; border-radius: inherit" height="90"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_real(5);">
                                <h1 class="is-text is-size-6  has-text-weight-semibold">scene#5</h1>
                                <input type="image" src="images/rgb/scene5/input.png"
                                       style="border: double; border-radius: inherit" height="90"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_real(6);">
                                <h1 class="is-text is-size-6  has-text-weight-semibold">scene#6</h1>
                                <input type="image" src="images/rgb/scene6/input.png"
                                       style="border: double; border-radius: inherit" height="90"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_real(7);">
                                <h1 class="is-text is-size-6  has-text-weight-semibold">scene#7</h1>
                                <input type="image" src="images/rgb/scene7/input.png"
                                       style="border: double; border-radius: inherit" height="90"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_real(8);">
                                <h1 class="is-text is-size-6  has-text-weight-semibold">scene#8</h1>
                                <input type="image" src="images/rgb/scene8/input.png"
                                       style="border: double; border-radius: inherit" height="90"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_real(9);">
                                <h1 class="is-text is-size-6  has-text-weight-semibold">scene#9</h1>
                                <input type="image" src="images/rgb/scene9/input.png"
                                       style="border: double; border-radius: inherit" height="90"/>
                            </button>

                            <p><br></p>

                            <script>
                                function change_scene_real(id) {
                                    rgb_main.src = "images/rgb/scene" + id + "/input.png";
                                    rgb_uw.src = "images/rgb/scene" + id + "/input.png";
                                    rgb_contrast.src = "images/rgb/scene" + id + "/contrast_stertch.png";
                                    rgb_gdcp.src = "images/rgb/scene" + id + "/GDCP.png";
                                    rgb_ucolor.src = "images/rgb/scene" + id + "/Ucolor.png";
                                    rgb_cwr.src = "images/rgb/scene" + id + "/CWR.png";
                                    rgb_semiuir.src = "images/rgb/scene" + id + "/semi-UIR.png";
                                    rgb_dm.src = "images/rgb/scene" + id + "/DM.png";
                                    rgb_osmosis.src = "images/rgb/scene" + id + "/osmosis.png";
                                    rgb_static.src = "images/rgb/scene" + id + "/osmosis.png";

                                    mainImage.style.borderColor = "#FFBF00";
                                    // replaceImage(dark, viewer)
                                }
                            </script>
                        </div>   
                    </div>
                    
                    <style>
                        /* Media query for narrow screens */
                        @media only screen and (max-width: 600px) {
                            .row {
                            flex-direction: column; /* Reverse the order for narrow screens */
                            }

                            .column {
                            width: 100%; /* Make each column take the full width */
                            }
                        }
                    </style>

                    <div class="row" style="display: flex; flex-wrap: wrap;">

                        <div class="column is-two-thirds">
                        <!-- <div class="column is-three-quarters"> -->
                            <a> 
                                <!-- <img class='llff-viewer' id="rgb_main" 
                                src="images/rgb/scene1/input.png"
                                style="width: 500px; height: 500px; display: block; margin: 100px auto 10px auto;">  -->
                                
                                <div id="mainImage" class="twentytwenty-container" 
                                style="max-width: 600px; height: auto; display: block; margin: 80px auto 10px auto;">
                                <!-- style="width: 600px; height: 600px; display: block; margin: 100px auto 10px auto;"> -->
                                    <img class='llff-viewer' id="rgb_static" src="images/rgb/scene1/osmosis.png" alt="Before" 
                                    style="border-style: none; max-width: 100%; height: auto;"/>
                                    <img class='llff-viewer' id="rgb_main" src="images/rgb/scene1/input.png" alt="After"
                                    style="border-style: none; max-width: 100%; height: auto;"/>
                                </div>
                            </a>
                        </div>
                        
                        <!-- results small images - with click option -->
                        
                            <!-- <h1 class="title is-6"> You can cycle through the images by pressing key
                                <span class="rcorners" style="border: 3px solid #FFBF00"> 1 </span> to
                                <span class="rcorners" style="border: 3px solid #CCCCFF"> 8 </span> .
                            </h1> -->
                        <div class="column">
                            <h1 class="title is-6">
                                Click on the image you wish to compare <br> it will be displayed on the right side
                            </h1>
                            
                            <div class="column-thumbnail-title">
                                <!-- column 1 -->
                                <div class="column-thumbnail" style="flex: 1;">
                                    <h1 class="is-text is-size-6 has-text-weight-semibold">1. Underwater</h1>
                                    <img src="images/rgb/scene1/input.png" id="rgb_uw" onload="setBorderReal(this);"
                                    onClick="replaceImageBorder(this,rgb_main,mainImage);">
                                    <!-- style="max-width: 110px; height: auto;"> -->
                                        <!-- onClick="replaceImage(this,rgb_main);"> -->

                                    <h1 class="is-text is-size-6 has-text-weight-semibold">2. Contrast Stretch</h1>
                                    <img src="images/rgb/scene1/contrast_stertch.png" id="rgb_contrast" onload="setBorderReal(this);"    
                                    onClick="replaceImageBorder(this,rgb_main,mainImage);">
                                    <!-- style="max-width: 110px; height: auto;">      -->
                                        <!-- onClick="replaceImage(this,rgb_main);"> -->

                                    <h1 class="is-text is-size-6 has-text-weight-semibold">3. GDCP <a class="ref" href="#gdcp">[1]</a> </h1>
                                    <img src="images/rgb/scene1/GDCP.png" id="rgb_gdcp" onload="setBorderReal(this);"
                                    onClick="replaceImageBorder(this,rgb_main,mainImage);">
                                    <!-- style="max-width: 110px; height: auto;"> -->
                                        <!-- onClick="replaceImage(this,rgb_main);"> -->

                                    <h1 class="is-text is-size-6 has-text-weight-semibold">4. Ucolor <a class="ref" href="#ucolor">[2]</a> </h1>
                                    <img src="images/rgb/scene1/Ucolor.png" id="rgb_ucolor" onload="setBorderReal(this);"
                                    onClick="replaceImageBorder(this,rgb_main,mainImage);">
                                    <!-- style="max-width: 110px; height: auto;"> -->
                                    <!-- onClick="replaceImage(this,rgb_main);"> -->
                                </div>
                                <!-- column 2 -->
                                <div class="column-thumbnail" style="flex: 1;">
                                    <h1 class="is-text is-size-6 has-text-weight-semibold">5. CWR <a class="ref" href="#cwr">[3]</a> </h1>
                                    <img src="images/rgb/scene1/CWR.png" id="rgb_cwr" onload="setBorderReal(this);"
                                    onClick="replaceImageBorder(this,rgb_main,mainImage);">
                                    <!-- style="max-width: 110px; height: auto;">     -->
                                    <!-- onClick="replaceImage(this,rgb_main);"> -->

                                    <h1 class="is-text is-size-6 has-text-weight-semibold">6. Semi-UIR <a class="ref" href="#semiuir">[4]</a> </h1>
                                    <img src="images/rgb/scene1/semi-UIR.png" id="rgb_semiuir" onload="setBorderReal(this);"
                                    onClick="replaceImageBorder(this,rgb_main,mainImage);">
                                    <!-- style="max-width: 110px; height: auto;"> -->
                                    <!-- onClick="replaceImage(this,rgb_main);"> -->

                                    <h1 class="is-text is-size-6 has-text-weight-semibold">7. DM <a class="ref" href="#dm">[5]</a> </h1>
                                    <img src="images/rgb/scene1/DM.png" id="rgb_dm" onload="setBorderReal(this);"
                                    onClick="replaceImageBorder(this,rgb_main,mainImage);">
                                    <!-- style="max-width: 110px; height: auto;"> -->
                                    <!-- onClick="replaceImage(this,rgb_main);"> -->

                                    <p class="is-text is-size-6 has-text-weight-semibold">8. Osmosis</p>
                                    <img src="images/rgb/scene1/osmosis.png" id="rgb_osmosis" onload="setBorderReal(this);"
                                    onClick="replaceImageBorder(this,rgb_main,mainImage);">
                                    <!-- style="max-width: 110px; height: auto;">      -->
                                    <!-- onClick="replaceImage(this,rgb_main);"> -->

                                </div>
                            </div>    
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Underwater Monocular Depth comparison -->
<section class="hero">
    <div class="hero-body">
        <div class="container">
            <div class="columns is-centered">
                <div class="column is-three-quarters has-text-centered">
                    <h1 class="title is-3">Underwater Monocular Depth Estimation</h1>
                    <h1 class="title is-5">Results Comparison for Depth Estimation</h1>
                    
                    <!-- <span class="link-block">
                        <a href=""
                           class="button is-normal is-rounded is-dark">
                          <span class="icon"> <i class="fas fa-images is-size-4"></i> </span>
                          <span> &nbsp Download Underwater Dataset</span>
                        </a>
                    </span>
                    <span class="link-block">
                        <a href=""
                           class="button is-normal is-rounded is-dark">
                          <span class="icon"> <i class="fas fa-images is-size-4"></i> </span>
                          <span> &nbsp Download results</span>
                        </a>
                    </span> -->

                    <br><br>
                    <p class="has-text-justified" style="font-size: 18px;">
                        Comparison with several underwater monocular depth methods. <br>
                        Select a scene from the upper row and a method from the right column. <br>
                        The input underwater image is labeled '1. Underwater,' and our result is '7. Osmosis'. <br>
                        The Osmosis result is shown on the left side, with the compared method displayed on the right.
                    </p>
                    <br>

                    <div class="row">

                        <!-- scenes small images - with click option -->
                        <div class="column-viewer">
                            <button class="button-syn" onclick="change_scene_depth(1);">
                                <h1 class="is-text is-size-6 has-text-weight-semibold">scene#1</h1>
                                <input type="image" src="images/depth/scene1/input_rgb.png"
                                       style="border: double; border-radius: inherit" height="90"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_depth(2);">
                                <h1 class="is-text is-size-6  has-text-weight-semibold">scene#2</h1>
                                <input type="image" src="images/depth/scene2/input_rgb.png"
                                       style="border: double; border-radius: inherit" height="90"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_depth(3);">
                                <h1 class="is-text is-size-6  has-text-weight-semibold">scene#3</h1>
                                <input type="image" src="images/depth/scene3/input_rgb.png"
                                       style="border: double; border-radius: inherit" height="90"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_depth(4);">
                                <h1 class="is-text is-size-6  has-text-weight-semibold">scene#4</h1>
                                <input type="image" src="images/depth/scene4/input_rgb.png"
                                       style="border: double; border-radius: inherit" height="90"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_depth(5);">
                                <h1 class="is-text is-size-6  has-text-weight-semibold">scene#5</h1>
                                <input type="image" src="images/depth/scene5/input_rgb.png"
                                       style="border: double; border-radius: inherit" height="90"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_depth(6);">
                                <h1 class="is-text is-size-6  has-text-weight-semibold">scene#6</h1>
                                <input type="image" src="images/depth/scene6/input_rgb.png"
                                       style="border: double; border-radius: inherit" height="90"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_depth(7);">
                                <h1 class="is-text is-size-6  has-text-weight-semibold">scene#7</h1>
                                <input type="image" src="images/depth/scene7/input_rgb.png"
                                       style="border: double; border-radius: inherit" height="90"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_depth(8);">
                                <h1 class="is-text is-size-6  has-text-weight-semibold">scene#8</h1>
                                <input type="image" src="images/depth/scene8/input_rgb.png"
                                       style="border: double; border-radius: inherit" height="90"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_depth(9);">
                                <h1 class="is-text is-size-6  has-text-weight-semibold">scene#9</h1>
                                <input type="image" src="images/depth/scene9/input_rgb.png"
                                       style="border: double; border-radius: inherit" height="90"/>
                            </button>

                            <p><br></p>
                            <script>
                                function change_scene_depth(id) {
                                    depth_main.src = "images/depth/scene" + id + "/input_rgb.png";
                                    depth_uw.src = "images/depth/scene" + id + "/input_rgb.png";
                                    depth_gdcp.src = "images/depth/scene" + id + "/GDCP_depth.png";
                                    depth_ibla.src = "images/depth/scene" + id + "/IBLA_depth.png";
                                    depth_uv.src = "images/depth/scene" + id + "/unveiling_depth.png";
                                    depth_uwnet.src = "images/depth/scene" + id + "/UW-Net_depth.png";
                                    depth_monouwnet.src = "images/depth/scene" + id + "/monoUWnet_depth.png";
                                    depth_osmosis.src = "images/depth/scene" + id + "/osmosis_depth.png";
                                    depth_static.src = "images/depth/scene" + id + "/osmosis_depth.png";

                                    mainDepth.style.borderColor = "#FFBF00";
                                }
                            </script>
                        </div>
                    </div>
                    
                    <style>
                        /* Media query for narrow screens */
                        @media only screen and (max-width: 600px) {
                            .row {
                            flex-direction: column; /* Reverse the order for narrow screens */
                            }

                            .column {
                            width: 100%; /* Make each column take the full width */
                            }
                        }
                    </style>

                    <div class="row" style="display: flex; flex-wrap: wrap;">

                        <div class="column is-two-thirds">
                            <a> 
                                <!-- <img class='llff-viewer' id="depth_main"
                                    src="images/depth/scene1/input_rgb.png"
                                    style="width: 500px; height: 500px; display: block; margin: 100px auto 10px auto;"/> -->

                                <div id="mainDepth" class="twentytwenty-container" 
                                style="max-width: 600px; height: auto; display: block; margin: 80px auto 10px auto;">
                                <!-- style="width: 600px; height: 600px; display: block; margin: 100px auto 10px auto;"> -->
                                    <img class='llff-viewer' id="depth_static" src="images/depth/scene1/osmosis_depth.png" alt="Before" 
                                        style="border-style: none; max-width: 100%; height: auto"/>
                                    <img class='llff-viewer' id="depth_main" src="images/depth/scene1/input_rgb.png" alt="After"
                                        style="border-style: none; max-width: 100%; height: auto"/>
                                </div>

                            </a>
                        </div>
                        
                        <div class="column">
                            <h1 class="title is-6">
                                Click on the image you wish to compare <br> it will be displayed on the right side
                            </h1>

                            <div class="column-thumbnail-title">
                                
                                <!-- <h1 class="title is-6"> You can cycle through the images by pressing key
                                    <span class="rcorners" style="border: 3px solid #FFBF00"> 1 </span> to
                                    <span class="rcorners" style="border: 3px solid #CCCCFF"> 7 </span> .
                                </h1> -->
                                

                                <div class="column-thumbnail" style="flex: 1;">
                                    <h1 class="is-text is-size-6 has-text-weight-semibold">1. Underwater</h1>
                                    <img src="images/depth/scene1/input_rgb.png" id="depth_uw" onload="setBorderDepth(this);"
                                    onClick="replaceImageBorder(this,depth_main,mainDepth);">
                                    <!-- onClick="replaceImage(this,depth_main);"> -->

                                    <h1 class="is-text is-size-6 has-text-weight-semibold">2. GDCP <a class="ref" href="#gdcp">[1]</a> </h1>
                                    <img src="images/depth/scene1/GDCP_depth.png" id="depth_gdcp" onload="setBorderDepth(this);"
                                    onClick="replaceImageBorder(this,depth_main,mainDepth);">     
                                    <!-- onClick="replaceImage(this,depth_main);"> -->

                                    <h1 class="is-text is-size-6 has-text-weight-semibold">3. IBLA <a class="ref" href="#ibla">[6]</a> </h1>
                                    <img src="images/depth/scene1/IBLA_depth.png" id="depth_ibla" onload="setBorderDepth(this);"
                                    onClick="replaceImageBorder(this,depth_main,mainDepth);">     
                                    <!-- onClick="replaceImage(this,depth_main);"> -->
                                </div>
                                <div class="column-thumbnail" style="flex: 1;">
                                    <h1 class="is-text is-size-6 has-text-weight-semibold">4. Unveiling <a class="ref" href="#uv">[7]</a> </h1>
                                    <img src="images/depth/scene1/unveiling_depth.png" id="depth_uv" onload="setBorderDepth(this);"
                                    onClick="replaceImageBorder(this,depth_main,mainDepth);">     
                                    <!-- onClick="replaceImage(this,depth_main);"> -->

                                    <h1 class="is-text is-size-6 has-text-weight-semibold">5. UW-Net <a class="ref" href="#uwnet">[8]</a> </h1>
                                    <img src="images/depth/scene1/UW-Net_depth.png" id="depth_uwnet" onload="setBorderDepth(this);"
                                    onClick="replaceImageBorder(this,depth_main,mainDepth);">     
                                    <!-- onClick="replaceImage(this,depth_main);"> -->

                                    <h1 class="is-text is-size-6 has-text-weight-semibold">6. monoUWnet <a class="ref" href="#monouwnet">[9]</a> </h1>
                                    <img src="images/depth/scene1/monoUWnet_depth.png" id="depth_monouwnet" onload="setBorderDepth(this);"
                                    onClick="replaceImageBorder(this,depth_main,mainDepth);">
                                    <!-- onClick="replaceImage(this,depth_main);"> -->

                                    <p class="is-text is-size-6 has-text-weight-semibold">7. Osmosis</p>
                                    <img src="images/depth/scene1/osmosis_depth.png" id="depth_osmosis" onload="setBorderDepth(this);"
                                    onClick="replaceImageBorder(this,depth_main,mainDepth);">     
                                    <!-- onClick="replaceImage(this,depth_main);"> -->
                                </div>
                            </div>
                        </div>        
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Template of NAN -->
<!--
<section class="hero">
    <div class="hero-body">
        <div class="container">
            <div class="columns is-centered">
                <div class="column has-text-centered">
                    <h1 class="title is-3">Underwater Monocular Depth Estimation</h1>
                    <h1 class="title is-6">Results Comparison for Depth Estimation</h1>
                    <span class="link-block">
                        <a href=""
                           class="button is-normal is-rounded is-dark">
                          <span class="icon"> <i class="fas fa-images is-size-4"></i> </span>
                          <span> &nbsp Download Underwater Dataset</span>
                        </a>
                    </span>
                    <span class="link-block">
                        <a href=""
                           class="button is-normal is-rounded is-dark">
                          <span class="icon"> <i class="fas fa-images is-size-4"></i> </span>
                          <span> &nbsp Download results</span>
                        </a>
                    </span>
                    <div class="row">
                        <div class="column-viewer">
                            <button class="button-syn" onclick="change_scene_syn(0);">
                                <h1 class="is-text is-size-4 has-text-weight-semibold">Fern</h1>
                                <input type="image" src="images/BD/llffn/0/gt.png"
                                       style="border: double; border-radius: inherit" height="50"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_syn(1);">
                                <h1 class="is-text is-size-4  has-text-weight-semibold">Flower</h1>
                                <input type="image" src="images/BD/llffn/1/gt.png"
                                       style="border: double; border-radius: inherit" height="50"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_syn(2);">
                                <h1 class="is-text is-size-4  has-text-weight-semibold">Fortress</h1>
                                <input type="image" src="images/BD/llffn/2/gt.png"
                                       style="border: double; border-radius: inherit" height="50"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_syn(3);">
                                <h1 class="is-text is-size-4  has-text-weight-semibold">Horns</h1>
                                <input type="image" src="images/BD/llffn/3/gt.png"
                                       style="border: double; border-radius: inherit" height="50"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_syn(4);">
                                <h1 class="is-text is-size-4  has-text-weight-semibold">Leaves</h1>
                                <input type="image" src="images/BD/llffn/4/gt.png"
                                       style="border: double; border-radius: inherit" height="50"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_syn(5);">
                                <h1 class="is-text is-size-4  has-text-weight-semibold">Orchids</h1>
                                <input type="image" src="images/BD/llffn/5/gt.png"
                                       style="border: double; border-radius: inherit" height="50"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_syn(6);">
                                <h1 class="is-text is-size-4  has-text-weight-semibold">Room</h1>
                                <input type="image" src="images/BD/llffn/6/gt.png"
                                       style="border: double; border-radius: inherit" height="50"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_syn(7);">
                                <h1 class="is-text is-size-4  has-text-weight-semibold">T-rex</h1>
                                <input type="image" src="images/BD/llffn/7/gt.png"
                                       style="border: double; border-radius: inherit" height="50"/>
                            </button>

                            <p><br></p>
                            <script>
                                function change_scene_syn(id) {
                                    syn_main.src = "images/BD/llffn/" + id + "/noisy.png";
                                    syn_noisy.src = "images/BD/llffn/" + id + "/noisy.png";
                                    syn_gt.src = "images/BD/llffn/" + id + "/gt.png";
                                    syn_avg.src = "images/BD/llffn/" + id + "/avg.png";
                                    syn_deeprep.src = "images/BD/llffn/" + id + "/deeprep.png";
                                    syn_bpn.src = "images/BD/llffn/" + id + "/bpn.png";
                                    syn_ibrnetn.src = "images/BD/llffn/" + id + "/ibrnetn.png";
                                    syn_nan.src = "images/BD/llffn/" + id + "/nan.png";
                                    // replaceImage(dark, viewer)
                                }
                            </script>
                            <a href='images/BD/llffn/0/noisy.png'> <img class='llff-viewer' id="syn_main"
                                                                     src="images/BD/llffn/0/noisy.png"></a>
                        </div>
                        <div class="column-thumbnail-title">
                            <h1 class="title is-6"> You can cycle through the images by pressing key
                                <span class="rcorners" style="border: 3px solid #FFBF00"> 1 </span> to
                                <span class="rcorners" style="border: 3px solid #CCCCFF"> 7 </span> .
                            </h1>
                            <div class="column-thumbnail">
                                <h1 class="is-text is-size-6 has-text-weight-semibold">1. Noisy frame</h1>
                                <img src="images/BD/llffn/0/noisy.png" id="syn_noisy" onload="setBorderSyn(this);"
                                     onClick="replaceImage(this,syn_main);">

                                <h1 class="is-text is-size-6 has-text-weight-semibold">2. GT frame</h1>
                                <img src="images/BD/llffn/0/gt.png" id="syn_gt" onload="setBorderSyn(this);"
                                     onClick="replaceImage(this,syn_main);">

                                <h1 class="is-text is-size-6 has-text-weight-semibold">3. Burst Average</h1>
                                <img src="images/BD/llffn/0/avg.png" id="syn_avg" onload="setBorderSyn(this);"
                                     onClick="replaceImage(this,syn_main);">
                            </div>
                            <div class="column-thumbnail">
                                <h1 class="is-text is-size-6 has-text-weight-semibold">4. BPN  <a class="ref" href="#bpn">[1]</a> </h1>
                                <img src="images/BD/llffn/0/bpn.png" id="syn_bpn" onload="setBorderSyn(this);"
                                     onClick="replaceImage(this,syn_main);">

                                <h1 class="is-text is-size-6 has-text-weight-semibold">5. Deep-Rep  <a class="ref" href="#deeprep">[2]</a> </h1>
                                <img src="images/BD/llffn/0/deeprep.png" id="syn_deeprep" onload="setBorderSyn(this);"
                                     onClick="replaceImage(this,syn_main);">

                                <h1 class="is-text is-size-6 has-text-weight-semibold">6. IBRNet-<i>N</i></h1>
                                <img src="images/BD/llffn/0/ibrnetn.png" id="syn_ibrnetn" onload="setBorderSyn(this);"
                                     onClick="replaceImage(this,syn_main);">

                                <p class="is-text is-size-6 has-text-weight-semibold">7. NAN</p>
                                <img src="images/BD/llffn/0/nan.png" id="syn_nan" onload="setBorderSyn(this);"
                                     onClick="replaceImage(this,syn_main);">
                            </div>
                        </div>
                    </div>
                    <br>
                    <br>
                    <p class="title is-4">Quantitative Evaluation</p>
                    <img class="figure" src="figures/metrics_BD.png">
                    <br>
                    <br>
                    <p class="title is-4 is-spaced">Comparison of Kernel Size and Bilateral in Post Processing</p>
                    <img class="figure" src="figures/metrics_kernels_BD.png">
                </div>
            </div>
        </div>
    </div>
</section>
-->


<!-- Algorithm Figure -->
<section class="hero">
    <div class="hero-body">
        <div class="container">
            <div class="columns is-centered">
                <div class="column is-three-quarters has-text-centered"> <!-- Centered column for the title -->
                    <h1 class="title is-3">Osmosis Algorithm Overview</h1>
                    
                    <p class="has-text-justified" style="font-size: 18px;">
                        The iterative sampling process starts in \(t = T\) with random noise in 4 channels. 
                        The denoising step outputs \(\mu\) and denoised samples \(\hat{x}_0\). 
                        We use the physical image formation model together with \(\hat{x}_0\) to optimize the water parameters \(\phi\). 
                        These are then input to the guided sampling. 
                        This process repeats itself until \(t = 0\), 
                        in which \(\hat{x}_0\) hold the method’s estimate 
                        for the reconstructed scene \(\hat{J}_0\) and its depth \(\hat{D}_0\)
                    </p>
                    <br>

                </div>
            </div>
            
            <div class="columns is-centered">
                <div class="column has-text-centered"> <!-- Centered column for the image -->
                    <img src="./figures/osmosis_flowchart_eccv2024.gif" loop>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Underwater Image Formation Model -->
<section class="hero">
    <div class="hero-body">
        <div class="container">
            <div class="columns is-centered">
                <div class="column is-three-quarters has-text-centered"> <!-- Centered column for the title -->
                    <h1 class="title is-3">Background</h1>
                    
                    <p class="has-text-justified" style="font-size: 18px;">
                        In water, we observe two wavelength- and distance- dependent effects. 
                        First, the \(\textit{direct}\) signal reflected from the object is attenuated. 
                        Second, light is scattered onto the object's line-of-sight (LOS), 
                        creating an additive signal termed \(\textit{backscatter}\) that increases with distance. 
                        The occluding backscatter layer is independent of the scene content. 
                        Thus, the visibility and contrast of further objects is significantly reduced 
                        and their colors are distorted.
                    </p>
                    <br>

                </div>
            </div>
            <div class="columns is-centered">
                <div class="column is-three-quarters has-text-centered"> <!-- Centered column for the image -->
                    <img src="./figures/new_formation_model.gif" loop>
                </div>
            </div>
        </div>
    </div>
</section>


<!-- Simulation Results Image Restoration -->
<!-- <section class="hero">
    <div class="hero-body">
        <div class="container">
            <div class="columns is-centered">
                <div class="column has-text-centered">
                    <h1 class="title is-3">Underwater Image Restoration - Simulation</h1>
                </div>
            </div>
        </div>
    </div>
</section> -->


<!-- Simulation Results Underwater Monocular Depth -->
<!-- <section class="hero">
    <div class="hero-body">
        <div class="container">
            <div class="columns is-centered">
                <div class="column has-text-centered">
                    <h1 class="title is-3">Underwater Monocular Depth - Simulation</h1>
                </div>
            </div>
        </div>
    </div>
</section> -->

<!-- <script>
    document.onkeydown = keyHandler;
</script> -->

<script>
    // document.onkeydown = keyHandler;
    $(window).on('load', function() {
        // Initialize TwentyTwenty plugin
        $(".twentytwenty-container").twentytwenty({
            default_offset_pct: 0.5,
            orientation: 'horizontal',
            before_label: 'Osmosis',
            after_label: 'Else',
            no_overlay: false,
            move_slider_on_hover: false,
            move_with_handle_only: true,
            click_to_move: false
        });
    });
</script>

<!-- BibTex -->
<section class="section" id="BibTeX">
    <div class="container content">
        <div class="columns is-centered has-text-centered">
            <div class="column is-three-quarters has-text-justified">
                <h2 class="title">Citation</h2>
                <pre><code>@article{nathan2024osmosis,
  title={Osmosis: RGBD Diffusion Prior for Underwater Image Restoration}, 
  author={Bar Nathan, Opher and Levy, Deborah and Treibitz, Tali and Rosenbaum, Dan},
  journal={arXiv preprint arXiv:2403.14837},
  year={2024}
}</code></pre>
            </div> 
        </div>
    </div>
</section>

<!-- references -->
<section class="section" id="refrences">
    <div class="container content">
        <div class="columns is-centered has-text-centered">
            <div class="column is-three-quarters has-text-justified">
                <h2 class="title">References</h2>
                <ol  class="citation-list">
                    <li class="citation-item"><a class="citation" id="gdcp">Peng, Yan-Tsung, et al.
                        "Generalization of the dark channel prior for single image restoration."
                        <i>IEEE TIP</i>, 2018. </a></li>
                    <li class="citation-item"><a class="citation" id="ucolor">Li, Chongyi, et al.
                        "Underwater image enhancement via medium transmission-guided multi-color space embedding."
                        <i>IEEE TIP</i>, 2021. </a></li>
                    <li class="citation-item"><a class="citation" id="cwr">Han, Junlin, et al.
                        "Underwater Image Restoration via Contrastive Learning and a Real-world Dataset."
                        <i>Remote Sensing</i>, 2022. </a></li>
                    <li class="citation-item"><a class="citation" id="semiuir">Huang, Shirui, et al.
                        "Contrastive semi-supervised learning for underwater image restoration via reliable bank."
                        <i>In Proc. IEEE CVPR</i>, 2023. </a></li>
                    <li class="citation-item"><a class="citation" id="dm">Tang, Yi, et al.
                        "Underwater image enhancement by transformer-based diffusion model with non-uniform sampling for skip strategy."
                        <i>In Proc. ACM International Conference on Multimedia</i>, 2023. </a></li>
                    <li class="citation-item"><a class="citation" id="ibla">Peng, Yan-Tsung, et al.
                        "Underwater image restoration based on image blurriness and light absorption."
                        <i>IEEE TIP</i>, 2017. </a></li>
                    <li class="citation-item"><a class="citation" id="uv">Bekerman, Yael, et al.
                        "Unveiling optical properties in underwater images."
                        <i>ICCP</i>, 2020. </a></li>
                    <li class="citation-item"><a class="citation" id="uwnet">Gupta, Honey, et al.
                        "Unsupervised single image underwater depth estimation."
                        <i>ICIP</i>, 2019. </a></li>
                    <li class="citation-item"><a class="citation" id="monouwnet">Amitai, Shlomi, et al.
                        "Self supervised monocular depth underwater."
                        <i>ICRA</i>, 2023. </a></li>
                </ol>
            </div>
        </div>
    </div>
</section>


<footer class="footer">
    <div class="container">
        <div class="columns is-centered">
            <div class="content has-text-centered">
                The website interface is adapted from <a href="https://github.com/nerfies/nerfies.github.io">nerfies</a>,
                <a href="https://noise-aware-nerf.github.io/">NAN</a>,
                <a href="https://dps2022.github.io/diffusion-posterior-sampling-page/">SeaThru-NeRF</a>
                and <a href="https://github.com/generativediffusionprior/generativediffusionprior.github.io/">GDP</a>.
                <br>
                We thank Nir Zagdanski for helping with the website.
            </div>
        </div>
    </div>
</footer>

</body>

</html>
