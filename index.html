<!DOCTYPE html>
<html>
<head>
    <!--    https://www.w3schools.com/tags/tag_meta.asp-->
    <meta charset="utf-8">
    <meta name="description" content="Osmosis: RGBD Diffusion Prior for Underwater Image Restoration">
    <meta name="keywords" content="Osmosis, Diffusion, Posterior Sampling, underwater, image restoration">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Osmosis: RGBD Diffusion Prior for Underwater Image Restoration</title>

    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'G-PYVRSFMDRL');
    </script>

    <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
          rel="stylesheet">

    <link rel="stylesheet" href="./static/css/bulma.min.css">
    <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
    <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
    <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
    <link rel="stylesheet" href="./static/css/index.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script defer src="./static/js/fontawesome.all.min.js"></script>
    <script src="./static/js/bulma-carousel.min.js"></script>
    <script src="./static/js/bulma-slider.min.js"></script>
    <script src="./static/js/index.js"></script>
    <!--    <script src='./static/js/jquery.elevatezoom.js'></script>-->
    <link rel="shortcut icon" href="images/lab_icon.png" type="image/png"/>
</head>
<body>

<section class="hero">
    <div class="hero-body">
        <div class="container">
            <div class="columns is-centered">
                <div class="column has-text-centered">
                    <h1 class="title is-3 publication-title">Osmosis: RGBD Diffusion Prior for Underwater Image Restoration</h1>
                    <h1 class="title is-1 publication-title">Under Contruction</h1>
                    <div class="is-size-5 publication-authors">
                        <span class="author-block">Opher Bar Nathan<sup>1</sup>,</span>
                        <span class="author-block">Deborah Levy<sup>1</sup>,</span>
                        <span class="author-block">
                            <a href="https://www.viseaon.haifa.ac.il/">Tali Treibitz</a><sup>1</sup>,
                        </span>
                        <span class="author-block">
                        <a href="https://danrsm.github.io/">Dan Rosenbaum</a><sup>2</sup>
                        </span>
                    </div>
                    <div class="is-size-5 publication-authors">
                        <span class="institution-block">
                          <span class="instit"><sup>1</sup>Dept. of Marine Technologies,
                            <br>School of Marine Sciences
                            <br>University of Haifa, Israel
                          </span>
                          <span class="instit"><sup>2</sup>Dept. of Computer Science,
                            <br>University of Haifa, Israel
                          </span>
                        </span>
                    </div>
                    <div class="column has-text-centered">
                        <div class="publication-links">
                            <!-- PDF Link. -->
                            <span class="link-block">
                                <!-- <a href="https://arxiv.org/abs/2204.04668" -->
                                <a href=""
                                    class="external-link button is-normal is-rounded is-dark">
                                    <span class="icon">
                                        <i class="ai ai-arxiv is-size-4"></i></span>
                                    <span>Paper</span>
                                </a>
                            </span>

                            <!-- <span class="link-block">
                                <a href="https://www.youtube.com/watch?v=jVqWGPzgrLw"
                                     class="external-link button is-normal is-rounded is-dark">
                                    <span class="icon">
                                        <i class="fab fa-youtube"></i>
                                    </span>
                                    <span>Video</span>
                                </a>
                            </span> -->
                           
                            <!-- Code Link. -->
                            <span class="link-block">
                            <a href="https://github.com/osmosis-diffusion/osmosis-diffusion-code"
                               class="external-link button is-normal is-rounded is-dark">
            <!--                   class="external-link button is-normal is-rounded is-dark">-->
                              <span class="icon">
                                  <i class="fab fa-github  is-size-4"></i>
                              </span>
                              <span>Code</span>
                              </a>
                          </span>
                        </div>
                    </div>
                    <img class="img-teaser" src="figures/teaser.png">
                </div>
            </div>
        </div>
    </div>
</section>

<!--abstract-->
<section class="section">
    <div class="container">
        <!-- Abstract. -->
        <div class="columns is-centered has-text-centered">
            <div class="column is-two-thirds">
                <h2 class="title is-2">Abstract</h2>
                <div class="content has-text-justified is-italic">
                    <p>
                        Underwater image restoration is a challenging task because of strong water effects that increase dramatically with distance. 
                        This is worsened by lack of ground truth data of clean scenes without water. 
                        Diffusion priors have emerged as strong image restoration priors. 
                        However, they are often trained with a dataset of the desired restored output, which is not available in our case. 
                    </p>
                    <p>  
                        To overcome this critical issue, we show how to leverage in-air images to train diffusion priors for underwater restoration. 
                        We observe that only color data is insufficient, and augment the prior with a depth channel. 
                        Thus, we train an unconditional diffusion model prior on the joint space of color and depth, using standard RGBD datasets of natural outdoor scenes in air.
                    </p>
                    <p>
                        Using this prior together with a novel guidance method based on the underwater image formation model, we generate posterior samples of clean images, removing the water effects. 
                        Even though our prior did not see any underwater images during training, 
                        our method outperforms state-of-the-art baselines both for image restoration and depth estimation on very challenging scenes.
                    </p>

                </div>
            </div>
        </div>
    </div>
</section>
<!--/ Abstract. -->


<section class="hero">
    <div class="hero-body">
        <div class="container">
            <div class="columns is-centered">
                <div class="column has-text-centered">
                    <h1 class="title is-3">Underwater Image Restoration</h1>
                    <h1 class="title is-6">Results Comparison for Underwater Image Restoration</h1>
                    <span class="link-block">
                        <a href=""
                           class="button is-normal is-rounded is-dark">
                          <span class="icon"> <i class="fas fa-images is-size-4"></i> </span>
                          <span> &nbsp Download Underwater Dataset</span>
                        </a>
                    </span>
                    <span class="link-block">
                        <a href=""
                           class="button is-normal is-rounded is-dark">
                          <span class="icon"> <i class="fas fa-images is-size-4"></i> </span>
                          <span> &nbsp Download Results</span>
                        </a>
                    </span>
                    <div class="row">
                        <div class="column-viewer">
                            <button class="button-syn" onclick="change_scene_real(0);">
                                <h1 class="is-text is-size-4 has-text-weight-semibold">Image#1</h1>
                                <input type="image" src="images/BD/real/0/nan.png"
                                       style="border: double; border-radius: inherit" height="50"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_real(1);">
                                <h1 class="is-text is-size-4  has-text-weight-semibold">Image#2</h1>
                                <input type="image" src="images/BD/real/1/nan.png"
                                       style="border: double; border-radius: inherit" height="50"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_real(2);">
                                <h1 class="is-text is-size-4  has-text-weight-semibold">Image#3</h1>
                                <input type="image" src="images/BD/real/2/nan.png"
                                       style="border: double; border-radius: inherit" height="50"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_real(3);">
                                <h1 class="is-text is-size-4  has-text-weight-semibold">Image#4</h1>
                                <input type="image" src="images/BD/real/3/nan.png"
                                       style="border: double; border-radius: inherit" height="50"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_real(4);">
                                <h1 class="is-text is-size-4  has-text-weight-semibold">Image#5</h1>
                                <input type="image" src="images/BD/real/4/nan.png"
                                       style="border: double; border-radius: inherit" height="50"/>
                            </button>

                            <p><br></p>
                            <script>
                                function change_scene_real(id) {
                                    real_main.src = "images/BD/real/" + id + "/dark.png";
                                    real_dark.src = "images/BD/real/" + id + "/dark.png";
                                    real_pre.src = "images/BD/real/" + id + "/pre.png";
                                    real_avg.src = "images/BD/real/" + id + "/avg.png";
                                    real_hdr.src = "images/BD/real/" + id + "/hdr.png";
                                    real_deeprep.src = "images/BD/real/" + id + "/deeprep.png";
                                    real_bpn.src = "images/BD/real/" + id + "/bpn.png";
                                    real_ibrnetn.src = "images/BD/real/" + id + "/ibrnetn.png";
                                    real_nan.src = "images/BD/real/" + id + "/nan.png";
                                    // replaceImage(dark, viewer)
                                }
                            </script>
                            <a href='images/BD/real/0/dark.png'> <img class='llff-viewer' id="real_main"
                                                                   src="images/BD/real/0/dark.png"></a>
                        </div>
                        <div class="column-thumbnail-title">
                            <h1 class="title is-6"> You can cycle through the images by pressing key
                                <span class="rcorners" style="border: 3px solid #FFBF00"> 1 </span> to
                                <span class="rcorners" style="border: 3px solid #CCCCFF"> 8 </span> .
                            </h1>
                            <div class="column-thumbnail">
                                <h1 class="is-text is-size-6 has-text-weight-semibold">1. Dark frame</h1>
                                <img src="images/BD/real/0/dark.png" id="real_dark" onload="setBorderReal(this);"
                                     onClick="replaceImage(this,real_main);">

                                <h1 class="is-text is-size-6 has-text-weight-semibold">2. Pre-processed</h1>
                                <img src="images/BD/real/0/pre.png" id="real_pre" onload="setBorderReal(this);"
                                     onClick="replaceImage(this,real_main);">

                                <h1 class="is-text is-size-6 has-text-weight-semibold">3. Burst Average</h1>
                                <img src="images/BD/real/0/avg.png" id="real_avg" onload="setBorderReal(this);"
                                     onClick="replaceImage(this,real_main);">

                                <h1 class="is-text is-size-6 has-text-weight-semibold">4. HDR+ <a class="ref" href="#hdr">[6]</a><sup>*</sup> </h1>
                                <img src="images/BD/real/0/hdr.png" id="real_hdr" onload="setBorderReal(this);"
                                     onClick="replaceImage(this,real_main);">
                            </div>
                            <div class="column-thumbnail">
                                <h1 class="is-text is-size-6 has-text-weight-semibold">5. BPN <a class="ref" href="#bpn">[1]</a> </h1>
                                <img src="images/BD/real/0/bpn.png" id="real_bpn" onload="setBorderReal(this);"
                                     onClick="replaceImage(this,real_main);">

                                <h1 class="is-text is-size-6 has-text-weight-semibold">6. Deep-Rep <a class="ref" href="#deeprep">[2]</a> </h1>
                                <img src="images/BD/real/0/deeprep.png" id="real_deeprep" onload="setBorderReal(this);"
                                     onClick="replaceImage(this,real_main);">

                                <h1 class="is-text is-size-6 has-text-weight-semibold">7. IBRNet-<i>N</i></h1>
<!--                                <img src="images/BD/real/0/ibrnetn.png" id="real_ibrnetn" onload="setBorderReal(this);"-->
                                <img src="images/BD/real/0/ibrnetn.png" id="real_ibrnetn" onload="setBorderReal(this);"
                                     onClick="replaceImage(this,real_main);">

                                <p class="is-text is-size-6 has-text-weight-semibold">8. NAN</p>
                                <img src="images/BD/real/0/nan.png" id="real_nan" onload="setBorderReal(this);"
                                     onClick="replaceImage(this,real_main);">

                            </div>
                            <h1><sup>*</sup>We use the implementation from <a class="ref" href="#hdrimp">[7]</a> </h1>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="hero">
    <div class="hero-body">
        <div class="container">
            <div class="columns is-centered">
                <div class="column has-text-centered">
                    <h1 class="title is-3">Monocular Depth Estimation</h1>
                    <h1 class="title is-6">Results Comparison for Depth Estimation</h1>
                    <span class="link-block">
                        <a href=""
                           class="button is-normal is-rounded is-dark">
                          <span class="icon"> <i class="fas fa-images is-size-4"></i> </span>
                          <span> &nbsp Download Underwater Dataset</span>
                        </a>
                    </span>
                    <span class="link-block">
                        <a href=""
                           class="button is-normal is-rounded is-dark">
                          <span class="icon"> <i class="fas fa-images is-size-4"></i> </span>
                          <span> &nbsp Download results</span>
                        </a>
                    </span>
                    <div class="row">
                        <div class="column-viewer">
                            <button class="button-syn" onclick="change_scene_syn(0);">
                                <h1 class="is-text is-size-4 has-text-weight-semibold">Fern</h1>
                                <input type="image" src="images/BD/llffn/0/gt.png"
                                       style="border: double; border-radius: inherit" height="50"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_syn(1);">
                                <h1 class="is-text is-size-4  has-text-weight-semibold">Flower</h1>
                                <input type="image" src="images/BD/llffn/1/gt.png"
                                       style="border: double; border-radius: inherit" height="50"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_syn(2);">
                                <h1 class="is-text is-size-4  has-text-weight-semibold">Fortress</h1>
                                <input type="image" src="images/BD/llffn/2/gt.png"
                                       style="border: double; border-radius: inherit" height="50"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_syn(3);">
                                <h1 class="is-text is-size-4  has-text-weight-semibold">Horns</h1>
                                <input type="image" src="images/BD/llffn/3/gt.png"
                                       style="border: double; border-radius: inherit" height="50"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_syn(4);">
                                <h1 class="is-text is-size-4  has-text-weight-semibold">Leaves</h1>
                                <input type="image" src="images/BD/llffn/4/gt.png"
                                       style="border: double; border-radius: inherit" height="50"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_syn(5);">
                                <h1 class="is-text is-size-4  has-text-weight-semibold">Orchids</h1>
                                <input type="image" src="images/BD/llffn/5/gt.png"
                                       style="border: double; border-radius: inherit" height="50"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_syn(6);">
                                <h1 class="is-text is-size-4  has-text-weight-semibold">Room</h1>
                                <input type="image" src="images/BD/llffn/6/gt.png"
                                       style="border: double; border-radius: inherit" height="50"/>
                            </button>

                            <button class="button-syn" onclick="change_scene_syn(7);">
                                <h1 class="is-text is-size-4  has-text-weight-semibold">T-rex</h1>
                                <input type="image" src="images/BD/llffn/7/gt.png"
                                       style="border: double; border-radius: inherit" height="50"/>
                            </button>

                            <p><br></p>
                            <script>
                                function change_scene_syn(id) {
                                    syn_main.src = "images/BD/llffn/" + id + "/noisy.png";
                                    syn_noisy.src = "images/BD/llffn/" + id + "/noisy.png";
                                    syn_gt.src = "images/BD/llffn/" + id + "/gt.png";
                                    syn_avg.src = "images/BD/llffn/" + id + "/avg.png";
                                    syn_deeprep.src = "images/BD/llffn/" + id + "/deeprep.png";
                                    syn_bpn.src = "images/BD/llffn/" + id + "/bpn.png";
                                    syn_ibrnetn.src = "images/BD/llffn/" + id + "/ibrnetn.png";
                                    syn_nan.src = "images/BD/llffn/" + id + "/nan.png";
                                    // replaceImage(dark, viewer)
                                }
                            </script>
                            <a href='images/BD/llffn/0/noisy.png'> <img class='llff-viewer' id="syn_main"
                                                                     src="images/BD/llffn/0/noisy.png"></a>
                            <!--                            <img src="images/BD/llffn/0/noisy.png" id="main_syn">-->
                        </div>
                        <div class="column-thumbnail-title">
                            <h1 class="title is-6"> You can cycle through the images by pressing key
                                <span class="rcorners" style="border: 3px solid #FFBF00"> 1 </span> to
                                <span class="rcorners" style="border: 3px solid #CCCCFF"> 7 </span> .
                            </h1>
                            <div class="column-thumbnail">
                                <h1 class="is-text is-size-6 has-text-weight-semibold">1. Noisy frame</h1>
                                <img src="images/BD/llffn/0/noisy.png" id="syn_noisy" onload="setBorderSyn(this);"
                                     onClick="replaceImage(this,syn_main);">

                                <h1 class="is-text is-size-6 has-text-weight-semibold">2. GT frame</h1>
                                <img src="images/BD/llffn/0/gt.png" id="syn_gt" onload="setBorderSyn(this);"
                                     onClick="replaceImage(this,syn_main);">

                                <h1 class="is-text is-size-6 has-text-weight-semibold">3. Burst Average</h1>
                                <img src="images/BD/llffn/0/avg.png" id="syn_avg" onload="setBorderSyn(this);"
                                     onClick="replaceImage(this,syn_main);">
                            </div>
                            <div class="column-thumbnail">
                                <h1 class="is-text is-size-6 has-text-weight-semibold">4. BPN  <a class="ref" href="#bpn">[1]</a> </h1>
                                <img src="images/BD/llffn/0/bpn.png" id="syn_bpn" onload="setBorderSyn(this);"
                                     onClick="replaceImage(this,syn_main);">

                                <h1 class="is-text is-size-6 has-text-weight-semibold">5. Deep-Rep  <a class="ref" href="#deeprep">[2]</a> </h1>
                                <img src="images/BD/llffn/0/deeprep.png" id="syn_deeprep" onload="setBorderSyn(this);"
                                     onClick="replaceImage(this,syn_main);">

                                <h1 class="is-text is-size-6 has-text-weight-semibold">6. IBRNet-<i>N</i></h1>
                                <img src="images/BD/llffn/0/ibrnetn.png" id="syn_ibrnetn" onload="setBorderSyn(this);"
                                     onClick="replaceImage(this,syn_main);">

                                <p class="is-text is-size-6 has-text-weight-semibold">7. NAN</p>
                                <img src="images/BD/llffn/0/nan.png" id="syn_nan" onload="setBorderSyn(this);"
                                     onClick="replaceImage(this,syn_main);">
                            </div>
                        </div>
                    </div>
                    <!-- <br> -->
                    <!-- <br> -->
                    <!-- <p class="title is-4">Quantitative Evaluation</p> -->
                    <!-- <img class="figure" src="figures/metrics_BD.png"> -->
                    <!-- <br> -->
                    <!-- <br> -->
                    <!-- <p class="title is-4 is-spaced">Comparison of Kernel Size and Bilateral in Post Processing</p> -->
                    <!-- <img class="figure" src="figures/metrics_kernels_BD.png"> -->
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    document.onkeydown = keyHandler;
</script>


<section class="section" id="BibTeX">
    <div class="container content">
        <h2 class="title">BibTeX</h2>
        <pre><code>???????</code></pre>
    </div>
</section>

<section class="section" id="refrences">
    <div class="container content">
        <div class="columns">
            <div class="column">
                <h1 class="title">References</h1>
                <ol  class="citation-list">
                    <li class="citation-item"><a class="citation" id="bpn">Xia, Zhihao, et al.
                        "Basis prediction networks for effective burst denoising with large kernels."
                        <i>In Proc. IEEE CVPR</i>, 2020. </a></li>
                    <li class="citation-item"><a class="citation" id="deeprep">Bhat, Goutam, et al.
                        "Deep reparametrization of multi-frame super-resolution and denoising."
                        <i>In Proc. IEEE ICCV</i>, 2021. </a></li>
                    <li class="citation-item"><a class="citation" id="ibrnet">Wang, Qianqian, et al.
                        "Ibrnet: Learning multi-view image-based rendering."
                        <i>In Proc. IEEE CVPR</i>, 2021. </a></li>
                    <li class="citation-item"><a class="citation" id="llff">Mildenhall, Ben, et al.
                        "Local light field fusion: Practical view synthesis with prescriptive sampling guidelines."
                        <i>ACM Transactions on Graphics</i>, 2019. </a></li>
                    <li class="citation-item"><a class="citation" id="nerf">Mildenhall, Ben, et al.
                        "Nerf: Representing scenes as neural radiance fields for view synthesis."
                        <i>In ECCV</i>, 2020. </a></li>
                    <li class="citation-item"><a class="citation" id="hdr">
                        Hasinoff, Samuel W., et al.
                        "Burst photography for high dynamic range and low-light imaging on mobile cameras."
                        <i>ACM Transactions on Graphics</i>, 2016. </a></li>
                    <li class="citation-item"><a class="citation" id="hdrimp">
                        Monod, Antoine, et al.
                        "An Analysis and Implementation of the HDR+ Burst Denoising Method."
                        <i>Image Processing On Line</i>, 2021. </a></li>
                </ol>
            </div>
        </div>
    </div>
</section>


<footer class="footer">
    <div class="container">
        <div class="columns is-centered">
            <div class="content has-text-centered">
                The website interface is adapted from <a href="https://github.com/nerfies/nerfies.github.io">nerfies</a>
                and
                <a href="http://jankautz.com/supplemental/FlexISP/">FlexISP</a>.
                <br>
                We thank Nir Zagdanski for helping with the website.
            </div>
        </div>
    </div>
</footer>

</body>
</html>
